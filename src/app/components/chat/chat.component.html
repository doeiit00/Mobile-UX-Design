<div class="chat">
  <div class="chat-header">{{ selectedChatName }}</div>

  <div class="chat-window" #chatWindow>
    <ul class="message-list">
      <li class="message-item">
        <mat-list class="message-list">
          <div>
            @if (message.length > 0) {
              @for(message of message; track message.id) {
                <div [ngClass]="{'message-incoming': message.usernick !== 'Dominik', 'message-outgoing': message.usernick === 'Dominik'}">
                  <p>{{message.usernick}}</p>
                  <p>{{message.text}}</p>
                  @if (photos[message.id]) {
                    <img [src]="photos[message.id]" alt="Message Photo"/>
                  }
                  <p>{{formatMyDate(message.time) || message.time}}</p>
                </div>
              }
            } @else {
              <h3>No messages found</h3>
            }
          </div>
        </mat-list>
      </li>
    </ul>
  </div>

  @if (isCameraOverlayVisible){
    <app-camera-overlay
      (photoCaptured)="handlePhotoCaptured($event)"
      (overlayClosed)="isCameraOverlayVisible = false">
    </app-camera-overlay>
  }

  <button mat-icon-button (click)="openCameraOverlay()">
    <mat-icon>camera_alt</mat-icon>
  </button>

  <form class="chat-input" (ngSubmit)="sendMessage()">
    <input type="text" class="message-input" placeholder="Type your message here" [(ngModel)]="text" name="text" autocomplete="off" />
    <button mat-icon-button class="send-button">
      <mat-icon>send</mat-icon>
    </button>
  </form>
</div>
